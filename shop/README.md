# Проект приложение "Интернет-магазин"
## Описание
Приложение разработано для интернет-магазина "MEGANO"".
## Функционал и структура приложения:
- Роли на сайте:
    - Незарегистрированный пользователь
    - Авторизованный покупатель
    - Продавец
    - Администратор
    
- Структура сайта для покупателя:
    - Каталог товаров:
      - по категориям
      - по тегам
      - по просмотрам
      - по новизне
      - по продажам
    - Детальная старинца товара
    - Корзина
    - Страница личного кабинета:
      - страница профиля
      - страница заказов
      - страница комментариев
      - страница адресов доставки
      - список квитанцией
    - Избранные товары
    - Товары для сравнения-
- Структура сайта для продавца:
    - Панель управления
    - Список магазинов
    - Детальная старинца магазина
    - Список заказов
    - Отзывы
    - Страница личного кабинета
- Структура сайта для администратора:
    - Панель упарвления 
    - Страница со:
        - списком покупателей
        - списком продавцов
        - списком магазинов
        - списком товаров
        - список заказов
    - Страница со категориями:
      - редактирование категорий
    - Страница с тегами:
      - редактирование тегов
    - Страница с отзывами:
      - модерация отзывов
  
## Статус проекта
_CREATED_


## Приложения в проекте:
    - Django - для разработки приложения
    - Celery - для работы с асинхронными задачами
    - Flower - для мониторинга и упраления Celery-задач
    - Postgres - для работы с базой данных приложения
    - Redis - брокер сообщений приложения
    - Nginx - для работы со статическими файлами приложения

## Деплой через Docker (первый способ)
Для установки проекта на свой компьютер, выполните следующие шаги:
1. установите Docker
2. клонируйте проект из git-репозитория  
3. запустите команды для создания образов и контейнеров
### Развертывание Docker-контейнеров с приложениями
В директории проекта через терминал введите следующую команду:
```
docker-compose build    # для создания образов приложений
docker-compose up       # для создания контейнеров 
```
## Деплой на сервер (второй способ)
Для установки проекта на свой компьютер, выполните следующие шаги:
1. установка виртуального окружения
2. установка зависимостей
3. клонирование репозитория   
4. создание моделей
5. создание базы данных
6. очистка кэша таблицы 'ContentType'
7. создание супер-пользователя
8. загрузка фикстур
9. сбор статических файлов
10. запуск сервера
11. запуск Celery и Flower
12. запуск Redis
### Установка виртуального окружения
В директории проекта через терминал введите следующую команду:
```
pip install virtualenv
python -m venv venv
venv\Scripts\activate.bat   # - для Windows;
source venv/bin/activate    # - для Linux и MacOS.
```
### Установка зависимостей
Установите все необходимые пакеты командой:
```
pip install -r requirenebts.txt
```
### Клонирование репозитория 
Скопируйте приложение из репозитория командой:
```
git clone https://...
```

### Создание моделей
Чтобы создать модели, введите команду:
```
python manage.py makemigrations
```
### Создание базы данных
Для создания базы данных введите следующую команду:
```
python manage.py migrate
```
### Очистка кэша таблицы contenttype
Для очистки кэша базы данных введите следующую команду:
```
manage.py shell  < installations/contenttype.py 
```
### Создание супер-пользователя
Для создания супер-пользователявведите следующую команду:
```
python manage.py shell  < installations/superusercreator.py     # из файла по дефолту
python manage.py createsuperuser                                # или создайте супер-пользователя самостоятельно
```
### Загрузить фикстуры
Для загрузки фикстур в базу данных введите команду:
```
python manage.py loaddata  fixtures/db.json
```
### Сбор статических файлов
Для сборки статики приложения введите команду:
```
python manage.py collectstatic  --noinput 
```
### Запуск сервера
Запустите сервер, введя команду:
```
python manage.py runserver
```
Остановить сервер, нажмите сочитание клавишь:
```
ctrl + C
```
### Запуск Celery и Flower
Запустите Celery, введя команду:
```
celery -A shop worker --pool=solo -l INFO
celery -A shop flower
```
### Запуск Redis
Запустите Redis, введя команду:
```
# Linux
redis-server        #  старт
redis-server stop   #  стоп
```
или запустите Redis из файла redis-server.exe (предварительно скачав Redis на свой компьютер)
## Табличное представление приложения:

| Приложение | Модель | Описание | Отношения |
| -------:|:-------|:----------|----------:|
| Товар | |||
|  | Item | модель для создания товара ||
|  | Category |модель для создания категории | FK к модели Item  |
|  | Tag |модель для создания тега | M2M к модели Item |
|  | Feature |модель для создания характеристики | FK к модели Category |
|  | FeatureValue |модель для создания значения характеристики| M2M к модели Item  |
|  | Image |модель для создания избражения | M2M к модели Item|
|  | Comment |модель для создания комментария | FK к модели Item, User |
|  | IpAddress |модель для создания IP-адреса |FK к модели User |
| Корзина | |||
|  | Cart |модель для создания корзины | FK к модели User |
|  | CartItem |модель для создания товара в корзине |FK к модели Cart |
| Квитанция | |||
|  | Invoice | модель для создания квитанции оплаты |FK к модели Order |
| Заказа | |||
|  | Order |модель для создания заказа | FK к модели User |
|  | OrderItem |модель для создания оплаченного товара|FK к модели Order |
|  | Address | модель для создания адреса доставки |FK к модели User|
| Настройки | |||
|  |SiteSettings | модель для создания настроек сайта |    |
| Магазин | |||
|  | Store | модель для создания магазина |FK к модели User | 
| Пользователь | |||
|  | Profile | модель для создания профиля прользователя | O2O к модели User | 
## Ссылки на документацию
- [Django]('https://docs.djangoproject.com/en/4.0/')
- [Celery]('https://docs.celeryq.dev/en/stable/index.html')
- [Flower]('https://flower.readthedocs.io/en/latest/index.html')
- [Redis]('https://redis.io/')
- [Postgres]('https://www.postgresql.org/docs/')
- [Nginx]('https://nginx.org/ru/')
